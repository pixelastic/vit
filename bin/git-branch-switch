#!/usr/bin/env zsh
# Switch to the specified branch
# If several branches are passed, switch to the first one that exists
#
# Usage :
# $ git-branch-switch master
# $ git-branch-switch master main
set -e

for branchName in $argv; do
  # Skip non-existing branches
  if ! git-branch-exists $branchName; then
    continue
  fi

  local previousCommit="$(git-commit-current)"

  # Switch to the branch
  git checkout --quiet $branchName

  # Update dependencies if needed
  git-dependencies-update $previousCommit

  # Stop when we found a matching branch
  break
done
