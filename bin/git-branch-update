#!/usr/bin/env zsh
# Synchronize local branches with remote ones:
# - Fetches all remote branch and track them locally
# - Remove any local branch that has been deleted on the remote
# - Does not remove local branches that were never pushed

if git fetch --all --prune &>/dev/null; then
  echo "âœ” Fetched all remote branches"
fi

git branch --no-color -r | while read remoteBranch
do
	if [[ $remoteBranch =~ "->" ]]; then
		continue;
	fi;

  localBranch=${remoteBranch/origin\/}
  if git branch $localBranch $remoteBranch &>/dev/null; then
    colorizedBranchName="$(git-branch-colorize ${localBranch} --with-icon)"
    echo "$colorizedBranchName tracked locally"
  fi
done 
